---
title: "[effective-java] enum ì— ëŒ€í•´ ì•Œì•„ë³´ê¸°(2)"
excerpt: "enum í™œìš©"

categories:
  - java-core
tags:
  - [java, enum]

permalink: /java-core/enum_2/

toc: true
toc_sticky: true

date: 2022-02-02
last_modified_at: 2022-02-02
---

## ğŸ¦¥ Enum í™œìš©

**ìŠ¤í”„ë§MVCì—ì„œì˜ enum í™œìš©**
  - ìŠ¤í”„ë§ mvc ì—ì„œ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ Stringì´ ì•„ë‹Œ enum ì„ í™œìš©
  - enum ì„ í™œìš©í•˜ì—¬ ìš”ì²­ê°’ì— íƒ€ì… ì•ˆì •ì„±ì„ ë¶€ì—¬
  - ê°„ë‹¨í•œ ìŠ¤í”„ë§ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ í†µí•´ ìƒ˜í”Œì½”ë“œë¥¼ ì‘ì„±í•¨.
  - ë³¸ ë¸”ë¡œê·¸ëŠ” íƒ€ ìœ ëª…ê°œë°œìì˜ ë¸”ë¡œê·¸ë¥¼ ì°¸ì¡°í•˜ì˜€ìœ¼ë©°, í•˜ë‹¨ì— ì°¸ì¡°ë¸”ë¡œê·¸ í‘œì‹œ

  - pom.xml

 ```xml
 <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
        </dependency>
        <!--thymeleaf-->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
        </dependency>
        <dependency>
            <groupId>nz.net.ultraq.thymeleaf</groupId>
            <artifactId>thymeleaf-layout-dialect</artifactId>
        </dependency>
        <!-- lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        <dependency>
            <groupId>com.github.gavlyukovskiy</groupId>
            <artifactId>p6spy-spring-boot-starter</artifactId>
            <version>1.5.6</version>
        </dependency>
 </dependencies>		
 ``` 
 
  - ê°„ë‹¨í•œ ì§ì›(Employee) ê´€ë¦¬ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ë‹¤. ë¨¼ì € ë°ì´í„° ë„ë©”ì¸ì„ ì •ì˜í•œë‹¤. 

```java
@Data
public class Employee {
	
	private long id;
	private String name;
	private DutyStep dutyStep;
	
	public Employee(String name, DutyStep dutyStep) {
		this.name = name;
		this.dutyStep = dutyStep;
	}
	
	//EnumModelì„ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ enumì„ key/value í˜•íƒœë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•œë‹¤.
	public enum DutyStep implements EnumModel{
		
		EL("ì‚¬ì›"), IL("ëŒ€ë¦¬"), VL("ê³¼ì¥");
		
		private String dutyName;
		
		DutyStep(String dutyName){
			this.dutyName = dutyName;
		}
		
		public String getDutyName() {
			return dutyName;
		}
		
		@Override public String toString() {
			return super.toString() +"[["+ getDutyName()+"]]";
		}
		
		@Override
		public String getKey() {
			return name();
		}
		
		@Override
		public String getValue() {
			return dutyName;
		}
	}
}
```

- Employee ë¥¼ ì €ì¥í•˜ëŠ” repository ë¥¼ ë§Œë“ ë‹¤. ê°„ë‹¨í•˜ê²Œ ë©”ëª¨ë¦¬(Map)ì— ì €ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•œë‹¤.

```java
@Repository
public class EmployeeRepository {
	
	private static final Map<Long, Employee> map = new HashMap<>();
	private static long sequence = 0L;
	
	public Employee save(Employee emp) {
		emp.setId(++sequence);
		map.put(emp.getId(), emp);
		return emp;
	}
	
	public List<Employee> findAll(){
		return new ArrayList<>(map.values());
	}
}
```

- í´ë¼ì´ì–¸íŠ¸ì—ì„œ Select box ëŠ” key ì™€ value ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. 
- ì„œë²„ì—ì„œ enum ì˜ key ì™€ value ë¥¼ ì œê³µí•´ì•¼ í•˜ë©°, í•´ë‹¹ ê¸°ëŠ¥ì„ ë¨¼ì € ì¸í„°í˜ì´ìŠ¤ë¡œ ì„ ì–¸í•œë‹¤. 

```java
public interface EnumModel {
	
	String getKey();
	String getValue();

}

```

- í´ë¼ì´ì–¸íŠ¸ì— ë„˜ê¸¸ enum Data ê°ì²´ë¥¼ ì •ì˜í•œë‹¤. 

```java
public class EnumValue {
	
	private String key;
	private String value;
	
	public EnumValue(EnumModel model) {
		this.key = model.getKey();
		this.value = model.getValue();
	}
	public String getKey() {
		return key;
	}
	public String getValue() {
		return value;
	}
}
```

- ë³´í†µ ê³µí†µì½”ë“œëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë™ ì´ˆê¸°ì— ë¡œë”©í•œë‹¤. ë§¤ë²ˆ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ enum Data ë¥¼ ìƒì„±í•˜ì§€ ì•Šê¸° ìœ„í•´ enum ì œê³µë¹ˆì„ ìƒì„±í•œë‹¤. 

```java
public class EnumMapper {
	
	// key : enum type , value : enum ìƒìˆ˜ë³„ ì¸ìŠ¤í„´ìŠ¤(EnumValue)
	private Map<Class<? extends EnumModel>, List<EnumValue>> map = new HashMap<>();
	
	private List<EnumValue> toEnumValue(Class<? extends EnumModel> clazz){
		return Arrays.stream(clazz.getEnumConstants())
				.map(EnumValue::new)
				.collect(Collectors.toList());
	}
	
	public void put(Class<? extends EnumModel> clazz) {
		map.put(clazz, toEnumValue(clazz));
	}
	
	public Map<Class<? extends EnumModel>, List<EnumValue>> getAll(){
		return map;
	}
	
	public List<EnumValue> get(Class<? extends EnumModel> clazz){
		return map.get(clazz);
	}
}
```

- @Configurationì„ í†µí•´ EnumMapperë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•œë‹¤. 

```java
@Configuration
public class AppConfig {
	
	@Bean
	public EnumMapper enumMapper() {
		EnumMapper enumMapper = new EnumMapper();
		//ê³µí†µ ì½”ë“œ enum ì„ ì¶”ê°€í•˜ë ¤ë©´ ì•„ë˜ enumMapper ì— put ì„ í•œë‹¤. 
		enumMapper.put(Employee.DutyStep.class);
		return enumMapper;
	}
}
```

- ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“ ë‹¤.

```java
@Slf4j
@Controller
@RequestMapping("/employee")
@RequiredArgsConstructor
public class EmployeeController {
	
	private final EmployeeRepository repository;
	private final EnumMapper enumMapper;
	
	@GetMapping("/all")
	@ResponseBody
	public List<Employee> getEmployeeList() {
		return repository.findAll();
	}
	
	@GetMapping("/registerForm")
	public String getDutyStep(Model model){
		//select box ì—ì„œ key  ì™€ value ë¡œ ë§¤í•‘í•œë‹¤. 
		model.addAttribute("dutyStep", enumMapper.get(Employee.DutyStep.class));
		
		return "registerForm";
	}
	
	@PostMapping("/register")
	public String post(@RequestParam(value="dutyStepName") DutyStep type, @RequestParam(value="name") String name) {
		log.info("type is {}, {}", type, name);
		repository.save(new Employee(name, type));
		return "redirect:/employee/all";
	}
}
```

- í´ë¼ì´ì–¸íŠ¸ html ì½”ë“œë¥¼ ë§Œë“ ë‹¤. ë·° í…œí”Œë¦¿ì—”ì§„ì€ Thymeleaf ë¥¼ ì‚¬ìš©í•œë‹¤. 

```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<body>
	<div class="container">
		<form role="form" action="/employee/register" method="post">
			<div class="form-group">
				<label for="count">ì´ë¦„</label> <input type="text" name="name"
					class="form-control" id="name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
			</div>
			<div class="form-group">
				<label for="employee">ì§ê¸‰</label> <select name="dutyStepName"
					id="dutyStepId" class="form-control">
					<option value="">ì§ê¸‰</option>
					<option th:each="step : ${dutyStep}" th:value="${step.key}"
						th:text="${step.value}" />
				</select>
			</div>
			<button type="submit" class="btn btn-primary">Submit</button>
		</form>
		<br />
	</div>
</body>
</html>

```

- ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ë™ í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤. 
- ì´ˆê¸°í™” í´ë˜ìŠ¤ì—ëŠ” Employee ê°ì²´ë¥¼ ëª‡ê°œ ìƒì„±í•˜ì—¬ë‘”ë‹¤. 

```java
@SpringBootApplication
@ComponentScan(basePackageClasses = {Page2BasePackage.class})
public class App {
	
	public static void main(String[] args) {
		SpringApplication.run(App.class, args);
	}
	
	@Component
	@RequiredArgsConstructor
	class AppInit implements ApplicationRunner{
		
		private final EmployeeRepository repository;

		@Override
		public void run(ApplicationArguments args) throws Exception {
			repository.save(new Employee("ê¹€ìœ¤ì•„", Employee.DutyStep.EL));
			repository.save(new Employee("ê¹€ê°œë˜¥", Employee.DutyStep.IL));
			repository.save(new Employee("í™ê¸¸ë™", Employee.DutyStep.VL));
		}
	}
}
```


# Reference
> - [ë¸”ë¡œê·¸ ì°¸ê³ ](https://jojoldu.tistory.com/122?category=635881
